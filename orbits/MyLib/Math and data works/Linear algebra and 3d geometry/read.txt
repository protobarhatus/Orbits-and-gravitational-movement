на самом деле тут хуйня, более полный вариант (с шаблонами и недостающими ф-ми) находится в difurs